---
layout: docs
page_title: Restore to single cluster
description: >-
  Recover and restore individual secrets from a saved storage snapshot to a
  single cluster
---

# Recover to a non-replicated cluster

@include 'alerts/enterprise-only.mdx'

Recover and restore a discrete secret from an integrated storage snapshot to a
single, non-replicated cluster.

@include 'sysadmin/snapshots/disabled-mount-warning.mdx'



## Before you start 

@include 'sysadmin/snapshots/restore-requirements/load-snapshots.mdx'

@include 'sysadmin/snapshots/restore-requirements/restore-secrets.mdx'



## Step 1: Load a snapshot

Load the snapshot holding the secret you want to recover.

<Tabs>

<Tab heading="Web UI" group="ui">

1. Open a web browser to access the Vault UI and sign in to the root namespace.
   <Tip title="Namespace restriction">

   Snapshot load and unload operations are restricted to the root namespace. All other snapshot operations 
   can be performed in other namespaces. 

    </Tip>

    <Tip title="Permissions Required">
        This requires snapshot management permissions.
    </Tip>

2. Select **Secrets Recovery** from the left navigation menu.

3. Select **Upload snapshot**.
    ![Load snapshot button location emphasized](/img/ui-secret-recovery-upload.png)

4. Select the method of upload. If loading from **automated** snapshots, an automated snapshot config is required.
Refer to the [automated snapshot API](https://developer.hashicorp.com/vault/api-docs/system/storage/raftautosnapshots#load-a-snapshot-from-an-automated-snapshot-configuration) 
to learn more about automated snapshots.
    ![Load snapshot form](/img/ui-secret-recovery-upload-form.png)

5. Click **Load snapshot** to complete the upload.
6. The status of the snapshot and the expiration date is shown. This also allows 
navigation to the snapshot details view.
    ![Snapshot overview card with status and details link emphasized](/img/ui-secret-recovery-overview-details.png)

</Tab>

<Tab heading="CLI" group="cli">

<Tabs>

<Tab heading="Manual snapshot" group="manual">

@include 'sysadmin/snapshots/load-snapshot/cli/manual.mdx'

</Tab>

<Tab heading="Automated snapshot" group="auto">

When you use Vault Enterprise with automated snapshots, you can load a snapshot
from cloud storage directly from the URL.

@include 'sysadmin/snapshots/load-snapshot/cli/auto.mdx'

</Tab>

</Tabs>

@include 'sysadmin/snapshots/check-status/cli.mdx'

</Tab>

<Tab heading="API" group="api">

<Tabs>

<Tab heading="Manual snapshot" group="manual">

@include 'sysadmin/snapshots/load-snapshot/api/manual.mdx'

</Tab>

<Tab heading="Automated snapshot" group="auto">

When you use Vault Enterprise with automated snapshots, you can load a snapshot
from cloud storage directly from the URL.

@include 'sysadmin/snapshots/load-snapshot/api/auto.mdx'

</Tab>

</Tabs>

@include 'sysadmin/snapshots/check-status/api.mdx'

</Tab>

</Tabs>

Status key | Description 
---------- | -----------
`loading`  | Vault is in the process of loading the snapshot and extracting data
`ready`    | Loading completed successfully. You can read data from the snapshot.
`error`    | Loading failed. Refer to the logs and `error` field for details.


### Use an autoloaded snapshot

If you configured automated snapshots with [autoloading enabled](/vault/docs/sysadmin/snapshots/automate#step-3-optional-enable-autoloading),
Vault Enterprise will automatically load a snapshot when the cluster starts and keep 
updating the loaded snapshot as new automated snapshots are created.

You can check for a loaded snapshot by listing the loaded snapshots: 

<Tabs>

<Tab heading="Web UI" group="ui">

1. Select **Secrets Recovery** from the left navigation menu.

2. If a snapshot has been loaded, it will appear here.
    ![Loaded snapshot card emphasized](/img/ui-secret-recovery-loaded-snapshot.png)

</Tab>
    
<Tab heading="CLI" group="cli">

@include 'sysadmin/snapshots/list-snapshots/cli.mdx'

</Tab>

<Tab heading="API" group="api">

@include 'sysadmin/snapshots/list-snapshots/api.mdx'

</Tab>

</Tabs>

## Step 2: Recover the secret

When the snapshot status is `ready`, you can recover the secret by specifying
the snapshot ID and the secret path you want to read from.

Vault reads the secret at the specified path from the snapshot and writes that
data to the associated path in Vault to recover the secret. The associated
plugin then creates or updates the data at the specified path in live cluster
storage.

<Tabs>

<Tab heading="Web UI" group="ui">
    <Tip title="Permissions Required">
        This requires read and/or recover permissions specific to the resource.
    </Tip>

1. A namespace selector will show when in the root namespace. Fill in the available fields to locate the secret to read or recover.
    ![Snapshot read and recover form fields](/img/ui-secret-recovery-fields.png)

2. Upon a successful read operation, the resource can be viewed as key value pairs or as JSON.
    ![Snapshot read view in key value format](/img/ui-secret-recovery-read-kv.png)
    ![Snapshot read view in JSON format](/img/ui-secret-recovery-read-json.png)
    
3. In addition to recovering to the original resource path, recovering a copy to a new path is possible. The original resource will be unaffected.
    ![Snapshot recovery to copy operation](/img/ui-secret-recovery-recover-copy.png)

</Tab>

<Tab heading="CLI" group="cli">

@include 'sysadmin/snapshots/secret-restore/recover/cli.mdx'

</Tab>

<Tab heading="API" group="api">

@include 'sysadmin/snapshots/secret-restore/recover/api.mdx'

</Tab>

</Tabs>



## Step 3: Verify secret recovery

<Tabs>

<Tab heading="Web UI" group="ui">
    <Tip title="Permissions Required">
        This requires recover permissions specific to the resource.
    </Tip>

Upon a successful recovery operation, a success message with a link to the recovered resource will be shown.
    ![Snapshot recovery operation](/img/ui-secret-recovery-recover-message.png)

</Tab>

<Tab heading="CLI" group="cli">

@include 'sysadmin/snapshots/secret-restore/verify/cli.mdx'

</Tab>

<Tab heading="API" group="api">

@include 'sysadmin/snapshots/secret-restore/verify/api.mdx'

</Tab>

</Tabs>
