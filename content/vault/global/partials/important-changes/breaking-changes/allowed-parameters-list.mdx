### Item-by-item list comparison for allowed_parameters and denied_parameters ((#allowed-parameters-list))

| Change       | Affected version | Vault edition
| ------------ | ---------------- | -------------
| Breaking     | 1.21.0+          | All

Prior to Vault 1.21, when a parameter in a request was subject to
`allowed_parameters` or `denied_parameters` checks and the parameter's value was
a list, Vault evaluated the **entire list** as a single value.
This meant Vault would only find a match if the **whole list** exactly matched
an entry in `allowed_parameters` or `denied_parameters`, which was often
unintuitive.

Starting with Vault 1.21, this behavior has changed.
When a parameter's value is a list, **each element** in that list is now checked
individually against the allowed or denied values.

#### Recommendation

Workflows that previously succeeded may now fail due to permission checks
involving `denied_parameters` because the new matching behavior correctly
identifies the fact that the list contains individually denied values even when
the exact list does not appear in the policy.

To address the broken workflow:
- Check whether or not your policies are overly restrictive.
- Update your workflows to avoid including explicitly denied values in lists.

You can temporarily revert to the deprecated matching behavior by setting the
`VAULT_LEGACY_EXACT_MATCHING_ON_LIST` environment variable on your Vault server.
